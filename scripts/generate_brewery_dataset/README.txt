# Generation of the dataset files

## Start virtual env & install dependencies
python -m venv .venv
source .venv/bin/activate
pip3 install faker

## Generate the dataset

```
python3 generate_brewery_dataset.py
```

## Number of bars & customers

The number of bars and customers can be forced by adding the -b and -c options:
```
python3 generate_brewery_dataset.py -b 1 -c 5
```

## Names localization

One or several locales can be forced by providing a comma-separated list of locales with the `-l` argument:
```
python3 generate_brewery_dataset.py -l FR
python3 generate_brewery_dataset.py -l FR,EN,ES,JA,ZH
```

# Dataset creation & upload

## Azure Storage upload

- first, open the [Azure Storage explorer](https://portal.azure.com/#view/Microsoft_Azure_Storage/StorageBrowserAccountPicker) in your browser, and find your organization and workspace.
- then, create a new folder and **upload the CSV files** generated by the script

## Dataset creation

This section illustrates how to create your dataset resource with Cosmo Tech API by using **restish** (but you could also use swagger).

First, you should create a JSON file with the metadata of the dataset you want to declare, including:
- the **connector id** of the Azure Storage connector
- the path to the dataset folder in Azure Storage
- the name and description of your dataset
- some tags to help identify your dataset -- note that it is important that your dataset has at least the tag **dataset** if you want to be able to create scenarios with it

Here is an example of JSON file that you can adapt for your dataset:
```json
{
  "compatibility": null,
  "connector": {
    "id": "c-d7e5p9o0kjn9",
    "name": "Azure Storage Connector",
    "parametersValues": {
      "AZURE_STORAGE_CONTAINER_BLOB_PREFIX": "%WORKSPACE_FILE%/brewery_instance_amsterdam"
    },
    "version": "1.1.1"
  },
  "description": "Amsterdam demo instance for the brewery solution",
  "fragmentsIds": null,
  "name": "Brewery Storage instance - Amsterdam",
  "tags": ["Storage", "Brewery", "Reference", "Amsterdam", "dataset"],
  "validatorId": null
}
```

Don't forget to change the entries:
- AZURE_STORAGE_CONTAINER_BLOB_PREFIX (in the "connector" entry)
- description
- name
- tags

Once your JSON file is ready, use restish to declare the dataset:
```
restish dev create-dataset $CSM_ORG < dataset.json
```
